This is a simple Huffman encoder!
